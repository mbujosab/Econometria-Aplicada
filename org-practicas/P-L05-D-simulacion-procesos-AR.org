#    -*- mode: org -*-

#+Title: Lección 5.D - Simulación de procesos AR(2) en la región de estacionariedad

#+author: Marcos Bujosa
#+LANGUAGE: es
#+OPTIONS: toc:nil
# +OPTIONS: author:nil
#+OPTIONS: date:nil

#+include: 00preambulo_practicas.txt

# +INFOJS_OPT: view:overview
# ###########
# ESTO DA EL FORMATO FINAL DE LA PÁGINA WEB VÉASE [[https://olmon.gitlab.io/org-themes/]]
# +SETUPFILE: ../css/bigblow_inline.theme
# ###########


#+name: setup-listings
#+begin_src emacs-lisp :exports none :results silent :tangle no
  (setq org-latex-listings 'listings)
  (setq org-latex-custom-lang-environments
  	;'((emacs-lisp "common-lispcode")))
  	'((emacs-lisp "hansl-gretl")))
  (setq org-latex-listings-options
	'(("frame" "lines")
	  ("basicstyle" "\\scriptsize")
	  ("basicstyle" "\\ttfamily")
	  ("numbers=none" "left")
	  ("backgroundcolor=\\color{lightgray!20}")
	  ("numberstyle" "\\tiny")))
  (setq org-latex-to-pdf-process
	'("pdflatex -interaction nonstopmode -output-directory %o %f"
	"pdflatex -interaction nonstopmode -output-directory %o %f"
	"pdflatex -interaction nonstopmode -output-directory %o %f"))
  (org-add-link-type
   "latex" nil
   (lambda (path desc format)
     (cond
      ((eq format 'html)
       (format "<span class=\"%s\">%s</span>" path desc))
      ((eq format 'latex)
       (format "\\%s{%s}" path desc)))))
#+end_src

#+NAME: if-no--guiones-makefir
#+BEGIN_SRC emacs-lisp :exports none :results silent :tangle no
(unless (file-directory-p "guiones")
  (make-directory "guiones"))
#+END_SRC

#+NAME: tangle-all-code-blocks
#+BEGIN_SRC emacs-lisp :exports none :results silent :tangle no
(org-babel-tangle)
#+END_SRC

#+begin_src emacs-lisp :results silent :exports none
  (org-babel-do-load-languages
   'org-babel-load-languages
   '((latex . t)))
#+end_src


#+name: execute-gretl-practice
#+PROPERTY: P-L05-D-simulacion-procesos-AR
#+BEGIN_SRC sh  :exports none  :results silent :var practica="P-L05-D-simulacion-procesos-AR"
rm -fr $(pwd)/$practica
mkdir -p $(pwd)/$practica 
DIRECTORIO="$(pwd)/$practica" gretlcli -b $(pwd)/guiones/$practica.inp
# zip $practica $practica.* $practica/*
#+END_SRC

#+begin_src gretl :tangle guiones/P-L05-D-simulacion-procesos-AR.inp :exports none :eval no
# Los dos primeros comandos son necesarios para que Gretl guarde los resultados de la práctica en el directorio de trabajo
# al ejecutar lo siguiente desde un terminal (use los nombres y ruta que correspondan)
#
#    DIRECTORIO="Nombre_Directorio_trabajo" gretlcli -b ruta/nombre_fichero_de_la_practica.inp
#
# Si esto no le funciona en su sistema, comente las siguientes dos líneas y sitúese en el directorio de trabajo de gretl
# que corresponda (configure dicho directorio de trabajo desde la ventana principal de Gretl).

string directory = getenv("DIRECTORIO")
set workdir "@directory"
#+end_src
# string directory = $(pwd) ~ "/P-L03-A-simulaciones"


#+LATEX: \maketitle


* Objetivo de la práctica

   | Guión: | [[https://mbujosab.github.io/Econometria-Aplicada/Practicas-html/guiones/P-L05-D-simulacion-procesos-AR.inp][P-L05-D-simulacion-procesos-AR.inp]] |

*Objetivo*

1. Observar la ACF y PACF de distintos modelos AR($2$) en las distintas regiones del triángulo de estacionariedad.

*Requerimientos previos*

Programe o recupere de una práctica anterior una función que simule procesos AR($q$)
#+name: Función SimuladorAR
#+BEGIN_SRC gretl :tangle ./guiones/P-L05-D-simulacion-procesos-AR.inp :eval no
function series SimuladorAR(matrix phi)
    # SimuladorAR(phi) simula un proceso AR(p), 
    # donde phi es el polinomio AR y p es su grado.
    scalar p = cols(phi)
    series U = normal(0,1)                    
    series Y = 0                              
    setinfo Y --description="Serie simulada"
    loop i = (p+1)..$nobs                     
        scalar comb_pasado_Yt = 0
        scalar perturbacion = U[i]
        loop j = 2..p
            comb_pasado_Yt += -phi[1,j] * Y[i-j+1]  # expresión abreviada
        endloop
        Y[i] = comb_pasado_Yt + perturbacion
    endloop
    return Y
end function
#+END_SRC

Para que se observe bien la estructura de las ACF y PACF estimadas, establezca un tamaño de muestra suficientemente grande.
#+BEGIN_SRC gretl :tangle ./guiones/P-L05-D-simulacion-procesos-AR.inp :eval no
# establecemos la muestra
nulldata 3500
setobs 12 1900:01 --time-series
#+END_SRC

Recuerde cómo usar la función
#+BEGIN_SRC gretl :tangle ./guiones/P-L05-D-simulacion-procesos-AR.inp :eval no
scalar phi1 = 0
scalar phi2 = 0.8
series X = SimuladorAR( {1, -phi1, -phi2} )
figura <- corrgm X 12
#+END_SRC

#+latex: \clearpage

* Actividad 1 - Probando pares de valores en distintas regiones de invertibilidad

Asigne varios pares de valores $\phi_1$ y $\phi_2$ que pertenezcan a cada una de las regiones indicadas en la figura y explore cómo se comportan la AFC y PACF en cada caso.

#+BEGIN_CENTER
#+attr_html: :width 600px
#+ATTR_LATEX: :width 0.6\textwidth :center 
[[file:./img/AR2roots.png]]
#+END_CENTER
# \[\gamma_1=-\phi_1(1-\phi_2)\sigma^2\;\qquad\gamma_2=-\phi_2\sigma^2\]
\[
\rho_1=\frac{-\phi_1}{1-\phi_2}
;\qquad
\rho_2=\frac{\phi_1^2}{1-\phi_2}+\phi_2
;\qquad
\rho_k=\phi_1\rho_{k-1}+\phi_2\rho_{k-2}
;\qquad
\pi_1=\rho_1
;\qquad
\pi_2=\phi_2
;\qquad
\pi_k=0,\; k\geq3
\]

** Zona 1

Correlogramas en zona 3
- $\phi_2=0.5$
- $\phi_1=0,\quad0.1,\quad0.2,\quad0.3,\quad0.4,\quad0.5$.

# Correlogramas en zona 1 (En todos los casos $\phi_2=0.5$):

# Caso 1: $\phi_1=0$, Caso 2: $\phi_1=0.1$, Caso 3: $\phi_1=0.2$, Caso 4: $\phi_1=0.3$, Caso 5: $\phi_1=0.4$ y Caso 6: $\phi_1=0.5$. 
#+BEGIN_SRC gretl  :tangle ./guiones/P-L05-D-simulacion-procesos-AR.inp :eval no  :exports results
scalar phi2 = 0.5
scalar n = 0
loop for (r=0; r<=1-phi2; r+=.1)
    n += 1
    scalar phi1 = r
    nombre = sprintf("Zona1-%d(%1.1f-%1.1f)", n, phi1, phi2)
    sname = sprintf("Caso_%d", n)
    series @sname = SimuladorAR( {1, -phi1,  -phi2} )
    corrgm @sname 12 --plot=@nombre.png
endloop
#+END_SRC

#+BEGIN_SRC bash :var dir="./P-L05-D-simulacion-procesos-AR/" :exports results :results raw
# Inicia el bloque de exportación a LaTeX
echo "#+BEGIN_EXPORT latex"
echo "\\begin{figure}[H]"
echo "\\centering"
# echo "\\captionsetup[figure]{labelformat=empty}" # Opcional: Oculta la etiqueta "Figure X"

# Itera sobre los archivos .png encontrados y genera el código minipage
find "$dir" -maxdepth 1 -type f -iname "Zona1-*.png" -print0 | sort -z | while IFS= read -r -d $'\0' file; do
    echo "\\begin{minipage}{0.17\\textwidth}"
    echo "  \\includegraphics[width=\\textwidth]{$file}"
    echo "\\end{minipage}%" # El '%' es CRUCIAL para evitar un salto de línea entre minipages
done

# Finaliza el entorno de figura
# echo "\\caption{Correlogramas en zona 1: Caso 1: $\phi_1=0$, Caso 2: $\phi_1=0.1$, Caso 3: $\phi_1=0.2$, Caso 4: $\phi_1=0.3$, Caso 5: $\phi_1=0.4$ y Caso 6: $\phi_1=0.5$. En todos los casos $\phi_2=0.5$.}"
echo "\\end{figure}"
echo "#+END_EXPORT"
#+END_SRC

#+RESULTS:
#+BEGIN_EXPORT latex
\begin{figure}[H]
\centering
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona1-1(0,0-0,5).png}
\end{minipage}%
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona1-2(0,1-0,5).png}
\end{minipage}%
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona1-3(0,2-0,5).png}
\end{minipage}%
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona1-4(0,3-0,5).png}
\end{minipage}%
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona1-5(0,4-0,5).png}
\end{minipage}%
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona1-6(0,5-0,5).png}
\end{minipage}%
\end{figure}
#+END_EXPORT

# +name: insertar-filas
#+begin_src emacs-lisp :results raw :exports results
(let ((imagenes (directory-files "P-L05-D-simulacion-procesos-AR/" t "^Zona1-.*\\.png$")))
  (concat "#+BEGIN_EXPORT HTML\n"
          "<div style=\"display: flex; justify-content: center; gap: 10px;\">\n"
          (mapconcat (lambda (f)
                       (format "<img src=\"%s\" style=\"max-width:16%%; height:auto;\"/>"
                               (file-relative-name f)))
                     imagenes
                     "\n")
          "\n</div>\n#+END_EXPORT"))
#+end_src

#+RESULTS:
#+BEGIN_EXPORT HTML
<div style="display: flex; justify-content: center; gap: 10px;">
<img src="P-L05-D-simulacion-procesos-AR/Zona1-1(0,0-0,5).png" style="max-width:16%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Zona1-2(0,1-0,5).png" style="max-width:16%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Zona1-3(0,2-0,5).png" style="max-width:16%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Zona1-4(0,3-0,5).png" style="max-width:16%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Zona1-5(0,4-0,5).png" style="max-width:16%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Zona1-6(0,5-0,5).png" style="max-width:16%; height:auto;"/>
</div>
#+END_EXPORT




** Zona 2

Correlogramas en zona 3
- $\phi_2=-0.5$
- $\phi_1=-0.5,\quad-0.4,\quad-0.3,\quad-0.2,\quad-0.1,\quad0$.

# Correlogramas en zona 2 (En todos los casos $\phi_2=0.5$):

# Caso 1: $\phi_1=-0.5$, Caso 2: $\phi_1=-0.4$, Caso 3: $\phi_1=-0.3$, Caso 4: $\phi_1=-0.2$, Caso 5: $\phi_1=-0.1$ y Caso 6: $\phi_1=0.0$. 
#+BEGIN_SRC gretl  :tangle ./guiones/P-L05-D-simulacion-procesos-AR.inp :eval no  :exports results
scalar phi2 = 0.5
scalar n = 0
loop for (r=phi2-1; r<=0; r+=.1)
    n += 1
    scalar phi1 = r
    nombre = sprintf("Zona2-%d(%1.1f-%1.1f)", n, phi1, phi2)
    sname = sprintf("Caso_%d", n)
    series @sname = SimuladorAR( {1, -phi1,  -phi2} )
    corrgm @sname 12 --plot=@nombre.png
endloop
#+END_SRC

#+BEGIN_SRC bash :var dir="./P-L05-D-simulacion-procesos-AR/" :exports results :results raw
# Inicia el bloque de exportación a LaTeX
echo "#+BEGIN_EXPORT latex"
echo "\\begin{figure}[H]"
echo "\\centering"
# Itera sobre los archivos .png encontrados y genera el código minipage
find "$dir" -maxdepth 1 -type f -iname "Zona2-*.png" -print0 | sort -z | while IFS= read -r -d $'\0' file; do
    echo "\\begin{minipage}{0.17\\textwidth}"
    echo "  \\includegraphics[width=\\textwidth]{$file}"
    echo "\\end{minipage}%" # El '%' es CRUCIAL para evitar un salto de línea entre minipages
done
# Finaliza el entorno de figura
echo "\\end{figure}"
echo "#+END_EXPORT"
#+END_SRC

#+RESULTS:
#+BEGIN_EXPORT latex
\begin{figure}[H]
\centering
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona2-1(-0,5-0,5).png}
\end{minipage}%
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona2-2(-0,4-0,5).png}
\end{minipage}%
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona2-3(-0,3-0,5).png}
\end{minipage}%
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona2-4(-0,2-0,5).png}
\end{minipage}%
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona2-5(-0,1-0,5).png}
\end{minipage}%
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona2-6(-0,0-0,5).png}
\end{minipage}%
\end{figure}
#+END_EXPORT


#+begin_src emacs-lisp :results raw :exports results
(let ((imagenes (directory-files "P-L05-D-simulacion-procesos-AR/" t "^Zona2-.*\\.png$")))
  (concat "#+BEGIN_EXPORT HTML\n"
          "<div style=\"display: flex; justify-content: center; gap: 10px;\">\n"
          (mapconcat (lambda (f)
                       (format "<img src=\"%s\" style=\"max-width:16%%; height:auto;\"/>"
                               (file-relative-name f)))
                     imagenes
                     "\n")
          "\n</div>\n#+END_EXPORT"))
#+end_src

#+RESULTS:
#+BEGIN_EXPORT HTML
<div style="display: flex; justify-content: center; gap: 10px;">
<img src="P-L05-D-simulacion-procesos-AR/Zona2-1(-0,5-0,5).png" style="max-width:16%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Zona2-2(-0,4-0,5).png" style="max-width:16%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Zona2-3(-0,3-0,5).png" style="max-width:16%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Zona2-4(-0,2-0,5).png" style="max-width:16%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Zona2-5(-0,1-0,5).png" style="max-width:16%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Zona2-6(-0,0-0,5).png" style="max-width:16%; height:auto;"/>
</div>
#+END_EXPORT


# +latex: \clearpage


** Zona 3

Correlogramas en zona 3
# - $\phi_2=-0.99$
# - $\phi_1=-1.99,\quad-1.6,\quad-1.2,\quad-0.8,\quad-0.4,\quad0$.
- $\phi_2=-0.9$
- $\phi_1\approx-1.9,\quad-1.5,\quad-1.2,\quad-0.8,\quad-0.4,\quad0$.

# +latex: \noindent
# Correlogramas en zona 3 (En todos los casos $\phi_3=-0.75$):

# +latex: \noindent
# Caso 1: $\phi_1=-1.75$, Caso 2: $\phi_1\quad=-1.4$, Caso 3: $\phi_1=-1.05$, Caso 4: $\phi_1=-0.7$, Caso 5: $\phi_1=-0.35$ y Caso 6: $\phi_1=0.0$. 
#+BEGIN_SRC gretl  :tangle ./guiones/P-L05-D-simulacion-procesos-AR.inp :eval no  :exports results
scalar phi2 = -0.99
scalar n = 0
loop for (r=phi2-1+0.01; r<=0.01; r+=.39)
    n += 1
    scalar phi1 = r
    nombre = sprintf("Zona3-%d(%1.1f-%1.1f)", n, phi1, phi2)
    sname = sprintf("Caso_%d", n)
    series @sname = SimuladorAR( {1, -phi1,  -phi2} )
    corrgm @sname 12 --plot=@nombre.png
endloop
#+END_SRC

#+BEGIN_SRC bash :var dir="./P-L05-D-simulacion-procesos-AR/" :exports results :results raw
# Inicia el bloque de exportación a LaTeX
echo "#+BEGIN_EXPORT latex"
echo "\\begin{figure}[H]"
echo "\\centering"
# Itera sobre los archivos .png encontrados y genera el código minipage
find "$dir" -maxdepth 1 -type f -iname "Zona3-*.png" -print0 | sort -z | while IFS= read -r -d $'\0' file; do
    echo "\\begin{minipage}{0.17\\textwidth}"
    echo "  \\includegraphics[width=\\textwidth]{$file}"
    echo "\\end{minipage}%" # El '%' es CRUCIAL para evitar un salto de línea entre minipages
done
# Finaliza el entorno de figura
echo "\\end{figure}"
echo "#+END_EXPORT"
#+END_SRC

#+RESULTS:
#+BEGIN_EXPORT latex
\begin{figure}[H]
\centering
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona3-1(-2,0--1,0).png}
\end{minipage}%
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona3-2(-1,6--1,0).png}
\end{minipage}%
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona3-3(-1,2--1,0).png}
\end{minipage}%
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona3-4(-0,8--1,0).png}
\end{minipage}%
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona3-5(-0,4--1,0).png}
\end{minipage}%
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona3-6(-0,0--1,0).png}
\end{minipage}%
\end{figure}
#+END_EXPORT

#+begin_src emacs-lisp :results raw :exports results
(let ((imagenes (directory-files "P-L05-D-simulacion-procesos-AR/" t "^Zona3-.*\\.png$")))
  (concat "#+BEGIN_EXPORT HTML\n"
          "<div style=\"display: flex; justify-content: center; gap: 10px;\">\n"
          (mapconcat (lambda (f)
                       (format "<img src=\"%s\" style=\"max-width:16%%; height:auto;\"/>"
                               (file-relative-name f)))
                     imagenes
                     "\n")
          "\n</div>\n#+END_EXPORT"))
#+end_src

#+RESULTS:
#+BEGIN_EXPORT HTML
<div style="display: flex; justify-content: center; gap: 10px;">
<img src="P-L05-D-simulacion-procesos-AR/Zona3-1(-2,0--1,0).png" style="max-width:16%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Zona3-2(-1,6--1,0).png" style="max-width:16%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Zona3-3(-1,2--1,0).png" style="max-width:16%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Zona3-4(-0,8--1,0).png" style="max-width:16%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Zona3-5(-0,4--1,0).png" style="max-width:16%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Zona3-6(-0,0--1,0).png" style="max-width:16%; height:auto;"/>
</div>
#+END_EXPORT

# +latex: \clearpage


** Zona 4

Correlogramas en zona 4
- $\phi_2=-0.99$
- $\phi_1=0,\quad0.4,\quad0.8,\quad1.2,\quad1.6,\quad1.99$.

# Caso 1: $0$, Caso 2: $\phi_1=0.4$, Caso 3: $\phi_1=0.8$, Caso 4: $\phi_1=1.2$, Caso 5: $\phi_1=1.6$ y Caso 6: $\phi_1<2$. 
# Caso 1: $\phi_1=0$, Caso 2: $\phi_1=0.35$, Caso 3: $\phi_1=0.7$, Caso 4: $\phi_1=1.05$, Caso 5: $\phi_1=1.4$ y Caso 6: $\phi_1=1.75$. 
#+BEGIN_SRC gretl  :tangle ./guiones/P-L05-D-simulacion-procesos-AR.inp :eval no  :exports results
scalar phi2 = -0.99
scalar n = 0
loop for (r=0; r<=1-phi2; r+=.39)
    n += 1
    scalar phi1 = r
    nombre = sprintf("Zona4-%d(%1.1f-%1.1f)", n, phi1, phi2)
    sname = sprintf("Caso_%d", n)
    series @sname = SimuladorAR( {1, -phi1,  -phi2} )
    corrgm @sname 12 --plot=@nombre.png
endloop
#+END_SRC

#+BEGIN_SRC bash :var dir="./P-L05-D-simulacion-procesos-AR/" :exports results :results raw
# Inicia el bloque de exportación a LaTeX
echo "#+BEGIN_EXPORT latex"
echo "\\begin{figure}[H]"
echo "\\centering"
# Itera sobre los archivos .png encontrados y genera el código minipage
find "$dir" -maxdepth 1 -type f -iname "Zona4-*.png" -print0 | sort -z | while IFS= read -r -d $'\0' file; do
    echo "\\begin{minipage}{0.17\\textwidth}"
    echo "  \\includegraphics[width=\\textwidth]{$file}"
    echo "\\end{minipage}%" # El '%' es CRUCIAL para evitar un salto de línea entre minipages
done
# Finaliza el entorno de figura
echo "\\end{figure}"
echo "#+END_EXPORT"
#+END_SRC

#+RESULTS:
#+BEGIN_EXPORT latex
\begin{figure}[H]
\centering
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona4-1(0,0--1,0).png}
\end{minipage}%
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona4-2(0,4--1,0).png}
\end{minipage}%
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona4-3(0,8--1,0).png}
\end{minipage}%
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona4-4(1,2--1,0).png}
\end{minipage}%
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona4-5(1,6--1,0).png}
\end{minipage}%
\begin{minipage}{0.17\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Zona4-6(2,0--1,0).png}
\end{minipage}%
\end{figure}
#+END_EXPORT

#+begin_src emacs-lisp :results raw :exports results
(let ((imagenes (directory-files "P-L05-D-simulacion-procesos-AR/" t "^Zona4-.*\\.png$")))
  (concat "#+BEGIN_EXPORT HTML\n"
          "<div style=\"display: flex; justify-content: center; gap: 10px;\">\n"
          (mapconcat (lambda (f)
                       (format "<img src=\"%s\" style=\"max-width:16%%; height:auto;\"/>"
                               (file-relative-name f)))
                     imagenes
                     "\n")
          "\n</div>\n#+END_EXPORT"))
#+end_src

#+RESULTS:
#+BEGIN_EXPORT HTML
<div style="display: flex; justify-content: center; gap: 10px;">
<img src="P-L05-D-simulacion-procesos-AR/Zona4-1(0,0--1,0).png" style="max-width:16%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Zona4-2(0,4--1,0).png" style="max-width:16%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Zona4-3(0,8--1,0).png" style="max-width:16%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Zona4-4(1,2--1,0).png" style="max-width:16%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Zona4-5(1,6--1,0).png" style="max-width:16%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Zona4-6(2,0--1,0).png" style="max-width:16%; height:auto;"/>
</div>
#+END_EXPORT


** Eje vertical

Correlogramas en zona 3
- $\phi_1=0$
- $\phi_2\approx-1,\quad-0.7,\quad-0.3,\quad0,\quad0.3,\quad0.7,\quad1$.

# Correlogramas en zona 1 (En todos los casos $\phi_2=0.5$):

# Caso 1: $\phi_1=0$, Caso 2: $\phi_1=0.1$, Caso 3: $\phi_1=0.2$, Caso 4: $\phi_1=0.3$, Caso 5: $\phi_1=0.4$ y Caso 6: $\phi_1=0.5$. 
#+BEGIN_SRC gretl  :tangle ./guiones/P-L05-D-simulacion-procesos-AR.inp :eval no  :exports results
scalar phi1 = 0
scalar n = 0
loop for (r=-.98; r<=1; r+=0.32)
    n += 1
    scalar phi2 = r
    nombre = sprintf("EjeVertical-%d(%1.1f-%1.1f)", n, phi1, phi2)
    sname = sprintf("Caso_%d", n)
    series @sname = SimuladorAR( {1, -phi1,  -phi2} )
    corrgm @sname 12 --plot=@nombre.png
endloop
#+END_SRC

#+BEGIN_SRC bash :var dir="./P-L05-D-simulacion-procesos-AR/" :exports results :results raw
# Inicia el bloque de exportación a LaTeX
echo "#+BEGIN_EXPORT latex"
echo "\\begin{figure}[H]"
echo "\\centering"
# echo "\\captionsetup[figure]{labelformat=empty}" # Opcional: Oculta la etiqueta "Figure X"

# Itera sobre los archivos .png encontrados y genera el código minipage
find "$dir" -maxdepth 1 -type f -iname "EjeVertical-*.png" -print0 | sort -z | while IFS= read -r -d $'\0' file; do
    echo "\\begin{minipage}{0.15\\textwidth}"
    echo "  \\includegraphics[width=\\textwidth]{$file}"
    echo "\\end{minipage}%" # El '%' es CRUCIAL para evitar un salto de línea entre minipages
done

# Finaliza el entorno de figura
# echo "\\caption{Correlogramas en zona 1: Caso 1: $\phi_1=0$, Caso 2: $\phi_1=0.1$, Caso 3: $\phi_1=0.2$, Caso 4: $\phi_1=0.3$, Caso 5: $\phi_1=0.4$ y Caso 6: $\phi_1=0.5$. En todos los casos $\phi_2=0.5$.}"
echo "\\end{figure}"
echo "#+END_EXPORT"
#+END_SRC

#+RESULTS:
#+BEGIN_EXPORT latex
\begin{figure}[H]
\centering
\begin{minipage}{0.15\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/EjeVertical-1(0,0--1,0).png}
\end{minipage}%
\begin{minipage}{0.15\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/EjeVertical-2(0,0--0,7).png}
\end{minipage}%
\begin{minipage}{0.15\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/EjeVertical-3(0,0--0,3).png}
\end{minipage}%
\begin{minipage}{0.15\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/EjeVertical-4(0,0--0,0).png}
\end{minipage}%
\begin{minipage}{0.15\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/EjeVertical-5(0,0-0,3).png}
\end{minipage}%
\begin{minipage}{0.15\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/EjeVertical-6(0,0-0,6).png}
\end{minipage}%
\begin{minipage}{0.15\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/EjeVertical-7(0,0-0,9).png}
\end{minipage}%
\end{figure}
#+END_EXPORT


#+begin_src emacs-lisp :results raw :exports results
(let ((imagenes (directory-files "P-L05-D-simulacion-procesos-AR/" t "^EjeVertical-.*\\.png$")))
  (concat "#+BEGIN_EXPORT HTML\n"
          "<div style=\"display: flex; justify-content: center; gap: 10px;\">\n"
          (mapconcat (lambda (f)
                       (format "<img src=\"%s\" style=\"max-width:13.5%%; height:auto;\"/>"
                               (file-relative-name f)))
                     imagenes
                     "\n")
          "\n</div>\n#+END_EXPORT"))
#+end_src

#+RESULTS:
#+BEGIN_EXPORT HTML
<div style="display: flex; justify-content: center; gap: 10px;">
<img src="P-L05-D-simulacion-procesos-AR/EjeVertical-1(0,0--1,0).png" style="max-width:13.5%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/EjeVertical-2(0,0--0,7).png" style="max-width:13.5%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/EjeVertical-3(0,0--0,3).png" style="max-width:13.5%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/EjeVertical-4(0,0--0,0).png" style="max-width:13.5%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/EjeVertical-5(0,0-0,3).png" style="max-width:13.5%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/EjeVertical-6(0,0-0,6).png" style="max-width:13.5%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/EjeVertical-7(0,0-0,9).png" style="max-width:13.5%; height:auto;"/>
</div>
#+END_EXPORT



** Parábola

Correlogramas en zona 3
- $\phi_1\approx-1.9,\quad-1.3,\quad-0.6,\quad0,\quad0.6,\quad1.3,\quad1.9$.
- $\phi_2=\frac{-\phi_1^2}{4}$

# Correlogramas en zona 1 (En todos los casos $\phi_2=0.5$):

# Caso 1: $\phi_1=0$, Caso 2: $\phi_1=0.1$, Caso 3: $\phi_1=0.2$, Caso 4: $\phi_1=0.3$, Caso 5: $\phi_1=0.4$ y Caso 6: $\phi_1=0.5$. 
#+BEGIN_SRC gretl  :tangle ./guiones/P-L05-D-simulacion-procesos-AR.inp :eval no  :exports results
scalar n = 0
loop for (r=-1.91; r<=2; r+=0.63)
    n += 1
    scalar phi1 = r
    scalar phi2 = -phi1*phi1/4
    nombre = sprintf("Parabola-%d(%1.1f-%1.1f)", n, phi1, phi2)
    sname = sprintf("Caso_%d", n)
    series @sname = SimuladorAR( {1, -phi1,  -phi2} )
    corrgm @sname 12 --plot=@nombre.png
endloop
#+END_SRC

#+BEGIN_SRC bash :var dir="./P-L05-D-simulacion-procesos-AR/" :exports results :results raw
# Inicia el bloque de exportación a LaTeX
echo "#+BEGIN_EXPORT latex"
echo "\\begin{figure}[H]"
echo "\\centering"
# echo "\\captionsetup[figure]{labelformat=empty}" # Opcional: Oculta la etiqueta "Figure X"

# Itera sobre los archivos .png encontrados y genera el código minipage
find "$dir" -maxdepth 1 -type f -iname "Parabola-*.png" -print0 | sort -z | while IFS= read -r -d $'\0' file; do
    echo "\\begin{minipage}{0.15\\textwidth}"
    echo "  \\includegraphics[width=\\textwidth]{$file}"
    echo "\\end{minipage}%" # El '%' es CRUCIAL para evitar un salto de línea entre minipages
done

# Finaliza el entorno de figura
# echo "\\caption{Correlogramas en zona 1: Caso 1: $\phi_1=0$, Caso 2: $\phi_1=0.1$, Caso 3: $\phi_1=0.2$, Caso 4: $\phi_1=0.3$, Caso 5: $\phi_1=0.4$ y Caso 6: $\phi_1=0.5$. En todos los casos $\phi_2=0.5$.}"
echo "\\end{figure}"
echo "#+END_EXPORT"
#+END_SRC

#+RESULTS:
#+BEGIN_EXPORT latex
\begin{figure}[H]
\centering
\begin{minipage}{0.15\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Parabola-1(-1,9--0,9).png}
\end{minipage}%
\begin{minipage}{0.15\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Parabola-2(-1,3--0,4).png}
\end{minipage}%
\begin{minipage}{0.15\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Parabola-3(-0,6--0,1).png}
\end{minipage}%
\begin{minipage}{0.15\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Parabola-4(-0,0--0,0).png}
\end{minipage}%
\begin{minipage}{0.15\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Parabola-5(0,6--0,1).png}
\end{minipage}%
\begin{minipage}{0.15\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Parabola-6(1,2--0,4).png}
\end{minipage}%
\begin{minipage}{0.15\textwidth}
  \includegraphics[width=\textwidth]{./P-L05-D-simulacion-procesos-AR/Parabola-7(1,9--0,9).png}
\end{minipage}%
\end{figure}
#+END_EXPORT


#+begin_src emacs-lisp :results raw :exports results
(let ((imagenes (directory-files "P-L05-D-simulacion-procesos-AR/" t "^Parabola-.*\\.png$")))
  (concat "#+BEGIN_EXPORT HTML\n"
          "<div style=\"display: flex; justify-content: center; gap: 10px;\">\n"
          (mapconcat (lambda (f)
                       (format "<img src=\"%s\" style=\"max-width:13.5%%; height:auto;\"/>"
                               (file-relative-name f)))
                     imagenes
                     "\n")
          "\n</div>\n#+END_EXPORT"))
#+end_src

#+RESULTS:
#+BEGIN_EXPORT HTML
<div style="display: flex; justify-content: center; gap: 10px;">
<img src="P-L05-D-simulacion-procesos-AR/Parabola-1(-1,9--0,9).png" style="max-width:13.5%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Parabola-2(-1,3--0,4).png" style="max-width:13.5%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Parabola-3(-0,6--0,1).png" style="max-width:13.5%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Parabola-4(-0,0--0,0).png" style="max-width:13.5%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Parabola-5(0,6--0,1).png" style="max-width:13.5%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Parabola-6(1,2--0,4).png" style="max-width:13.5%; height:auto;"/>
<img src="P-L05-D-simulacion-procesos-AR/Parabola-7(1,9--0,9).png" style="max-width:13.5%; height:auto;"/>
</div>
#+END_EXPORT



#+latex: \clearpage

#+BEGIN_EXPORT latex
\textbf{Código completo de la práctica}

%| Guión completo: | [[https://mbujosab.github.io/Econometria-Aplicada/Practicas-html/guiones/P-L05-D-simulacion-procesos-AR.inp][P-L05-D-simulacion-procesos-AR.inp]] |

\lstinputlisting{guiones/P-L05-D-simulacion-procesos-AR.inp}
#+END_EXPORT

